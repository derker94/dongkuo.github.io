---
layout: post
title:  "希尔排序——算法导论(补充1)"
date:   2015-09-13 14:04:11 +0800
categories: 算法
tags: 算法导论  希尔排序 插入排序
---

> 转载请注明出处，谢谢。

## 1. 写在最前面

在[第1篇](http://blog.xtuapp.club/2015/09/05/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80.html)中，我们介绍了 *插入排序*（直接插入排序 ），在这一篇博客中，我们来学习两种种改良版的 *插入排序* —— **希尔排序**。

## 2. 直接插入排序

在[第1篇博客](http://blog.xtuapp.club/2015/09/05/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80.html)中已经给出了插入排序的算法的介绍，并做了简单的分析，不再赘述。这里直接给出结论：
1. 直接插入排序的时间复杂度在O(n) ~ O(n²)之间;
2. 它对基本有序的序列的排序速度较快，对于随机情况（O(n² / 4)）基本和最坏情况一样坏。

## 3. 希尔排序

### 算法介绍

*希尔排序(Shell Sort)* 是根据它的提出者[Donald Shell](https://en.wikipedia.org/wiki/Donald_Shell)来命名的。它与 *直接插入排序* 的区别在于，*直接插入排序* 的被比较对象总是和相邻的元素的去比较，即比较对象的**增量（步长）**为1；而*希尔排序*则打破了这点，它会自由的选择*增量（步长）*。

下面给出具体的算法描述：

1. 将待排序的序列分成若干组，每组由若干一定间距（称为增量）的元素组成。在一个组内，采用直接插入排序算法排序；
2. 增量序列最一般的选择是**希尔增量**，它的初值为序列长度的一半，之后每趟减半，最终为1。
3. 当某趟增量为1，完成本趟的直接插入排序后，整个序列即为排好序的。

下面给出 *Java* 实现代码：

```java
/**
 * 插入排序
 *
 * @param a
 */
public static void insertSort(int[] a, int step) {
    for (int i = step; i < a.length; i++) {
        int j = i - step;
        int curr = a[i];
        while (j > -1 && curr < a[j]) {
            a[j + step] = a[j];
            j -= step;
        }
        a[j + step] = curr;
    }
}

/**
 * 增量为shell增量的希尔排序
 *
 * @param a
 */
public static void shellSort(int[] a) {
    for (int step = a.length / 2; step > 0; step /= 2) {
        insertSort(a, step);
    }
}
```

上述代码相比于原 *插入排序* 改动并不大，只是为 `insertSort`方法加了一个step的参数。`shellSort`方法会根据排序的进行程度传入不同的`step`；而 *直接插入排序* 可以看成`step`总为1的`insertSort`方法。从这种角度看，*直接插入排序* 实际上是 *希尔排序* 的一种情形。

### 算法证明

当step为1时，即对整个序列进行了 *直接插入排序*。结束后，整个序列当然是排好序的。

### 算法分析

乍一看好像 *希尔排序* 相比于 *直接插入排序* 做了许多 `step` 不同的额外调用，其时间复杂度应该更高，但其实不然。

我们知道，写操作比读操作是更耗时的。*直接插入排序* 每次都是以1为步长去移动一个元素；而 *希尔排序* 每次可以移动多步或一步。这样，采用*希尔排序*，一个元素从它原来的位置，移动到它排好序的位置所用的次数较少，即写操作较少。但 *希尔排序* 会更多次地比较两个元素，因此它的读操作与其他的额外操作会较多，但这是值得的。

*希尔排序* 巧妙地避开了直接插入排序的缺点，而利用了它的优点：在最开始时，不管序列有多混乱，它的步长较大，各分组内的元素较小，利用直接插入排序效率是比较高的；随着排序的进行，步长越来越小，各分组内的元素慢慢增加，但各分组内的元素已基本有序，此时利用直接插入排序效率依然较高。

关于 *希尔排序* 的具体分析据说还是未解之谜，因此不再深入。至于增量的选取，可见 [张连堂，张 博. 希尔排序最佳增量序列研究](http://wenku.baidu.com/link?url=zMZ9x5ZioVEZ6Cgg0tf8AKsB5qYg2D7qSlsZyWt2PfJSbP39eSZZUSF1hhU5XXSNnfBLhKYNPNgQ5OO8HGwRNjqZ4MuQamlOGXvnHy7dqk_)

## 编程实验

对于1w、10w、50w 规模的**顺序序列**、**逆序序列**、**随机序列**，分别采用 *直接插入排序* 和 *希尔排序* 进行排序，实验结果如下：

|  单位:ms    |1w          | 10w           | 50w              |
|-------------|------------|---------------|------------------|
|直接插入排序 |0 - 72 - 44 |1 - 7042 - 3530|1 - 176475 - 88147|
|希尔排序     |1 - 1 - 3   |2 - 4 - 17     |14 - 20 - 94      |

实验结果与分析是一致的。


> 以上内容大部分摘自《算法导论》第3版的中文译本，其中少部分加入了一些个人理解，仅供参考；有些句子和词由于是翻译过来的，所以可能比较突兀，会意就好。
