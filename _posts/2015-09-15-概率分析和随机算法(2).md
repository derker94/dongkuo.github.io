---
layout: post
title:  "概率分析和随机算法(2)——算法导论(6)"
date:   2015-09-14 14:04:11 +0800
categories: 算法
tags: 算法导论  概率分析 随机算法
---

> 转载请注明出处，谢谢。

## 1. 写在最前面

关于概率分析和随机算法，在原书中介绍了几个有趣的例子，这篇博客主要介绍其中的一个叫做 **生日悖论** 的例子。

## 2. 生日悖论

#### 问题的提出

问题的提法很简单：

> 一个屋子里人数必须要达到多少人，才能使其中两人的生日相同的机会达到50%。

我们可能认为是365 / 2，但事实上，答案是一个出乎意料的很小的数值。

#### 分析问题

需要提前说明的是：

1. 我们对屋子里的k个人进行了从1~k的依次编号；
2. 我们不考虑闰年的情况，即1年是N = 365天。我们对每一天也进行了编号，编号方式是一年中的第n天编号为n；
3. 我们设bi表示编号为i的人的生日，bi = n表示编号为i的人的生日是编号为n的那天。显然有，1≤bi≤365。
4. 我们还假设生日均匀分布在一年中的n天中，因此概率P(bi = n) = 1 / N;

我们首先找出问题的关键。这个问题的关键就是**人数(设为k)和他们中两人生日相同的概率(设为P1)的关系。**

要分析P1，我们可以从两个方面（直接正面思考和从其对立面思考）进行思考：

1. **正面思考**，即考虑**存在两人生日相同的概率**。
不失一般性，我们记bi和bj分别表示i和j两人的生日，那么两人生日落在第n天的概率P(bi = bj = n) = P(bi = n) * P(bj = n) = 1 / N²。那么两人生日落在同一天的概率：
$$
P(b_i=b_j)=\sum_{n=1}^NP(b_i=b_j=n) = \frac{1}{N}
$$
我们用计数变量X<sub>ij</sub>来表示i和j两人的生日是否相同（如果相同X<sub>ij</sub> = 1，否则X<sub>ij</sub> = 0），由上面的结论，P(X<sub>ij</sub>) = 1 / N；我们设随机变量X表示k人中生日两两相同的对数，则：
$$
X=\sum_{i=1}^k\sum_{j=1,j≠i}^kX_{ij}
$$
$$
E(X)=E(\sum_{i=1}^k\sum_{j=1,j≠i}^kX_{ij}) =\sum_{i=1}^k\sum_{j=1,j≠i}^kE(x_{ij})=C_k^2\frac{1}{N}=\frac{k(k-1)}{2N}
$$
由E(X) ≥1可解得，n≥28。这就是说，屋子里至少需要有28人，我们可以期望找到至少一对人生日相同。

2. **对立面思考**，即考虑**任意两人生日都不同的概率**。
我们设A<sub>i</sub>表示对于所有j < i，i与j生日都不同的事件；设B<sub>k</sub>表示k个人生日都不同的事件,则：
$$
B_k=\bigcap_{i=1}^kA_i=A_k\bigcap B_{k-1}
$$
由[贝叶斯定理](http://baike.baidu.com/link?url=QLFqsGkFNoUx-3ZOpzpD-ze6OcerLCYtUojssiHmYPiVRVolJUB5dQrEoTRHx37CM4a8mnoKsacm39rNp1p02K)，
$$
P(B_k)=P(B_{k-1})P(A_k|B_{k-1})
$$
由此我们可以递归的得到：
$$
\begin{eqnarray*}
P(B_k)&=&P(B_{k-1})P(A_k|B_{k-1})\\
&=&P(B_{k-2})P(A_{k-1}|B_{k-2})P(A_{k}|B_{k-1})\\
&...&\\
&=&P(B_1)P(A_2|B_1)P(A_3|B_2)...P(A_{k-1}|B_{k-2})P(A_k|B_{k-1})
\end{eqnarray*}
$$
显然，P(B<sub>1</sub>)=1，而P(A<sub>k</sub>|B<sub>k</sub>-1)=(n - k + 1) / n（因为P(A<sub>k</sub>|B<sub>k</sub> - 1)的意思是在k - 1人生日都不同的情况下，第k个人生日与前面k - 1个人不同的概率），因此有：
$$
\begin{eqnarray*}
P(B_k)&=&1\cdot(\frac{n-1}{n})\cdot(\frac{n-2}{n})\cdot\cdot\cdot(\frac{n-k+1}{n})\\
&=&1\cdot(1-\frac{1}{n})\cdot(1-\frac{2}{n})\cdot\cdot\cdot(1-\frac{k+1}{n})
\end{eqnarray*}
$$
由不等式
$$
1+x≤e^x
$$
我们得出：
$$
P(B)≤e^{-1/n}e^{-2/n}\cdot\cdot\cdot e^{-(k-1)/n}=e^{-k(k-1)/2n}
$$
由1-P(B<sub>k</sub>)<=50%得：k≥23。这就是说如果至少有23个人在一间屋子里，那么至少有两个人生日相同的概率至少是50%。

## 3. 总结

第一种分析方式使用了指示器随机变量，给出了相同生日期望为1时的人数；而第二种方式仅使用了概率，确定了为使至少存在一对人生日相同的事件发生的概率大于50%，至少需要多少人。虽然两种情形下人的准确数目不同，但它们在**渐进阶数**上是相等的，都为θ(√n)（如果去解上面的不等式，你就会发现）。

> 以上内容大部分摘自《算法导论》第3版的中文译本，其中少部分加入了一些个人理解，仅供参考；有些句子和词由于是翻译过来的，所以可能比较突兀，会意就好。
